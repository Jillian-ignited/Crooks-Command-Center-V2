<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crooks & Castles Command Center</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%); color: #ffffff; min-height: 100vh; }
        .header { background: rgba(0, 0, 0, 0.8); padding: 1rem 2rem; border-bottom: 2px solid #333; display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 1.5rem; font-weight: bold; }
        .nav-buttons { display: flex; gap: 1rem; }
        .nav-btn { padding: 0.75rem 1.5rem; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; color: white; transition: all 0.3s ease; }
        .nav-btn.calendar { background: #4CAF50; }
        .nav-btn.assets { background: #2196F3; }
        .nav-btn.agency { background: #FF9800; }
        .nav-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.3); }
        .main-content { padding: 2rem; max-width: 1400px; margin: 0 auto; }
        .section { background: rgba(255, 255, 255, 0.05); border-radius: 12px; padding: 2rem; margin-bottom: 2rem; backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .section h2 { margin-bottom: 1.5rem; color: #ffffff; font-size: 1.8rem; }
        .timeline-buttons { display: flex; gap: 1rem; margin-bottom: 2rem; flex-wrap: wrap; }
        .timeline-btn { padding: 0.75rem 1.5rem; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; color: white; transition: all 0.3s ease; }
        .timeline-btn.day7 { background: #9C27B0; }
        .timeline-btn.day30 { background: #00BCD4; }
        .timeline-btn.day60 { background: #E91E63; }
        .timeline-btn.day90 { background: #673AB7; }
        .timeline-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.3); }
        .calendar-content { min-height: 400px; }
        .day-section { background: rgba(255, 255, 255, 0.08); border-radius: 8px; padding: 1.5rem; margin-bottom: 1rem; border-left: 4px solid #4CAF50; }
        .day-header { font-size: 1.2rem; font-weight: bold; margin-bottom: 1rem; color: #4CAF50; }
        .post-item { background: rgba(255, 255, 255, 0.1); border-radius: 6px; padding: 1rem; margin-bottom: 0.5rem; border-left: 3px solid #2196F3; }
        .post-title { font-weight: bold; margin-bottom: 0.5rem; color: #ffffff; }
        .post-meta { display: flex; gap: 1rem; margin-bottom: 0.5rem; font-size: 0.9rem; color: #cccccc; flex-wrap: wrap; }
        .badge-score { background: #4CAF50; color: white; padding: 0.2rem 0.5rem; border-radius: 4px; font-size: 0.8rem; font-weight: bold; }
        .post-content { color: #e0e0e0; font-size: 0.9rem; line-height: 1.4; }
        .assets-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 1.5rem; }
        .asset-card { background: rgba(255, 255, 255, 0.08); border-radius: 8px; padding: 1rem; transition: transform 0.3s ease; border: 1px solid rgba(255, 255, 255, 0.1); }
        .asset-card:hover { transform: translateY(-4px); box-shadow: 0 8px 25px rgba(0,0,0,0.3); }
        .asset-thumbnail { width: 100%; height: 150px; background: rgba(255, 255, 255, 0.1); border-radius: 6px; margin-bottom: 1rem; display: flex; align-items: center; justify-content: center; color: #888; font-size: 0.9rem; }
        .asset-info h3 { margin-bottom: 0.5rem; color: #ffffff; font-size: 1rem; }
        .asset-meta { display: flex; justify-content: space-between; align-items: center; margin-top: 0.5rem; }
        .tracking-stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-bottom: 2rem; }
        .stat-card { background: rgba(255, 255, 255, 0.08); border-radius: 8px; padding: 1.5rem; text-align: center; border: 1px solid rgba(255, 255, 255, 0.1); }
        .stat-value { font-size: 2.5rem; font-weight: bold; margin-bottom: 0.5rem; }
        .stat-label { color: #cccccc; font-size: 0.9rem; }
        .progress-bar { background: rgba(255, 255, 255, 0.1); border-radius: 10px; height: 20px; margin: 1rem 0; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, #4CAF50, #45a049); border-radius: 10px; transition: width 0.3s ease; }
        .hidden { display: none; }
        .loading { text-align: center; padding: 2rem; color: #888; }
        .no-content { text-align: center; padding: 2rem; color: #888; font-style: italic; }
        @media (max-width: 768px) {
            .header { flex-direction: column; gap: 1rem; }
            .nav-buttons { flex-wrap: wrap; justify-content: center; }
            .timeline-buttons { justify-content: center; }
            .main-content { padding: 1rem; }
            .post-meta { flex-direction: column; gap: 0.5rem; }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">üè∞ CROOKS & CASTLES COMMAND CENTER</div>
        <div class="nav-buttons">
            <button class="nav-btn calendar" onclick="showSection('calendar')">Calendar Planning</button>
            <button class="nav-btn assets" onclick="showSection('assets')">Asset Library</button>
            <button class="nav-btn agency" onclick="showSection('agency')">Agency Tracking</button>
        </div>
    </div>
    
    <div class="main-content">
        <div id="calendar-section" class="section">
            <h2>Strategic Calendar Planning</h2>
            <div class="timeline-buttons">
                <button class="timeline-btn day7" onclick="loadCalendar('7day')">7-Day Tactical</button>
                <button class="timeline-btn day30" onclick="loadCalendar('30day')">30-Day Strategic</button>
                <button class="timeline-btn day60" onclick="loadCalendar('60day')">60-Day Opportunities</button>
                <button class="timeline-btn day90" onclick="loadCalendar('90day')">90-Day+ Vision</button>
            </div>
            <div id="calendar-content" class="calendar-content">
                <div class="loading">Select a timeline to view strategic content planning</div>
            </div>
        </div>
        
        <div id="assets-section" class="section hidden">
            <h2>üé® Enhanced Asset Library</h2>
            <div id="assets-content" class="assets-grid">
                <div class="loading">Loading assets...</div>
            </div>
        </div>
        
        <div id="agency-section" class="section hidden">
            <h2>üìä Agency Tracking Dashboard</h2>
            <div id="agency-content">
                <div class="loading">Loading agency data...</div>
            </div>
        </div>
    </div>
    
    <script>
        let currentSection = 'calendar';
        
        function showSection(section) {
            document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
            document.getElementById(section + '-section').classList.remove('hidden');
            currentSection = section;
            
            if (section === 'assets') {
                loadAssets();
            } else if (section === 'agency') {
                loadAgencyTracking();
            }
        }
        
        function loadCalendar(timeframe) {
            const content = document.getElementById('calendar-content');
            content.innerHTML = '<div class="loading">Loading calendar data...</div>';
            
            fetch(`/api/calendar/${timeframe}`)
                .then(response => response.json())
                .then(data => {
                    displayCalendar(data, timeframe);
                })
                .catch(error => {
                    console.error('Error loading calendar:', error);
                    content.innerHTML = '<div class="no-content">Error loading calendar data</div>';
                });
        }
        
        function displayCalendar(data, timeframe) {
            const content = document.getElementById('calendar-content');
            
            if (!data.success || !data.calendar_data) {
                content.innerHTML = '<div class="no-content">No calendar data available</div>';
                return;
            }
            
            let html = `<h3>${getTimeframeTitle(timeframe)}</h3>`;
            
            data.calendar_data.forEach(day => {
                html += `<div class="day-section">`;
                html += `<div class="day-header">${day.day_name}, ${day.formatted_date}</div>`;
                
                if (day.posts.length === 0) {
                    html += `<div class="no-content">No posts scheduled</div>`;
                } else {
                    day.posts.forEach(post => {
                        html += `
                            <div class="post-item">
                                <div class="post-title">${post.title}</div>
                                <div class="post-meta">
                                    <span>${post.platform}</span>
                                    <span>‚è∞ ${post.time_slot}</span>
                                    <span class="badge-score">${post.badge_score}%</span>
                                </div>
                                <div class="post-content">${post.content}</div>
                            </div>
                        `;
                    });
                }
                
                html += `</div>`;
            });
            
            content.innerHTML = html;
        }
        
        function getTimeframeTitle(timeframe) {
            const titles = {
                '7day': '7-Day Tactical Execution',
                '30day': '30-Day Strategic Planning',
                '60day': '60-Day Opportunity Mapping',
                '90day': '90-Day+ Vision Planning'
            };
            return titles[timeframe] || 'Calendar Planning';
        }
        
        function loadAssets() {
            const content = document.getElementById('assets-content');
            content.innerHTML = '<div class="loading">Loading assets...</div>';
            
            fetch('/api/assets')
                .then(response => response.json())
                .then(data => {
                    displayAssets(data);
                })
                .catch(error => {
                    console.error('Error loading assets:', error);
                    content.innerHTML = '<div class="no-content">Error loading assets</div>';
                });
        }
        
        function displayAssets(assets) {
            const content = document.getElementById('assets-content');
            
            if (!assets || assets.length === 0) {
                content.innerHTML = '<div class="no-content">No assets available</div>';
                return;
            }
            
            let html = '';
            assets.forEach(asset => {
                html += `
                    <div class="asset-card">
                        <div class="asset-thumbnail">
                            üì∏ ${asset.category || 'Asset'}
                        </div>
                        <div class="asset-info">
                            <h3>${asset.original_name || asset.name || 'Unnamed Asset'}</h3>
                            <p style="color: #ccc; font-size: 0.9rem;">${asset.cultural_relevance || 'No description'}</p>
                            <div class="asset-meta">
                                <span class="badge-score">${asset.badge_score || 0}%</span>
                                <span style="color: #888; font-size: 0.8rem;">${asset.created_date ? new Date(asset.created_date).toLocaleDateString() : 'Unknown'}</span>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            content.innerHTML = html;
        }
        
        function loadAgencyTracking() {
            const content = document.getElementById('agency-content');
            content.innerHTML = '<div class="loading">Loading agency data...</div>';
            
            // Mock agency data for demo
            const agencyData = {
                overall_progress: 55.6,
                phase: 1,
                monthly_budget: 4000,
                deliverables: {
                    social_posts: { target: 12, delivered: 6, percentage: 50.0 },
                    ad_creatives: { target: 4, delivered: 8, percentage: 200.0 },
                    email_campaigns: { target: 2, delivered: 0, percentage: 0.0 }
                }
            };
            
            displayAgencyTracking(agencyData);
        }
        
        function displayAgencyTracking(data) {
            const content = document.getElementById('agency-content');
            
            let html = `
                <div class="tracking-stats">
                    <div class="stat-card">
                        <div class="stat-value" style="color: #4CAF50;">${data.overall_progress}%</div>
                        <div class="stat-label">Overall Progress</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" style="color: #2196F3;">Phase ${data.phase}</div>
                        <div class="stat-label">Current Phase</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" style="color: #FF9800;">$${data.monthly_budget}</div>
                        <div class="stat-label">Monthly Budget</div>
                    </div>
                </div>
                
                <h3 style="margin-bottom: 1rem;">üìà Deliverable Progress</h3>
            `;
            
            Object.keys(data.deliverables).forEach(key => {
                const deliverable = data.deliverables[key];
                const name = key.replace('_', ' ').replace(/\b\w/g, l => l.toUpperCase());
                
                html += `
                    <div style="margin-bottom: 1.5rem;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                            <span>${name}</span>
                            <span>${deliverable.delivered}/${deliverable.target} (${deliverable.percentage}%)</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${Math.min(deliverable.percentage, 100)}%;"></div>
                        </div>
                    </div>
                `;
            });
            
            content.innerHTML = html;
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            showSection('calendar');
        });
    </script>
</body>
</html>
