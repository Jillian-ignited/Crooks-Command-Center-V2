<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crooks & Castles Command Center V2 - Enhanced</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .gradient-border {
            background: linear-gradient(45deg, #FF6B35, #F7931E);
            padding: 2px;
            border-radius: 12px;
        }
        .gradient-border > div {
            background: #1a1a1a;
            border-radius: 10px;
            padding: 1.5rem;
        }
        .gradient-text {
            background: linear-gradient(45deg, #FF6B35, #F7931E);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .shimmer {
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: shimmer 2s infinite;
        }
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        .particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: #FF6B35;
            border-radius: 50%;
            animation: float 6s infinite ease-in-out;
        }
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); opacity: 0; }
            50% { transform: translateY(-20px) rotate(180deg); opacity: 1; }
        }
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }
        .notification.show {
            transform: translateX(0);
        }
        .notification.success {
            background: linear-gradient(45deg, #10B981, #059669);
        }
        .notification.error {
            background: linear-gradient(45deg, #EF4444, #DC2626);
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .upload-area {
            border: 2px dashed #FF6B35;
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .upload-area:hover {
            border-color: #F7931E;
            background: rgba(255, 107, 53, 0.05);
        }
        .upload-area.dragover {
            border-color: #F7931E;
            background: rgba(255, 107, 53, 0.1);
        }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen">
    <!-- Background particles -->
    <div class="fixed inset-0 overflow-hidden pointer-events-none">
        <div class="particle" style="left: 10%; animation-delay: 0s;"></div>
        <div class="particle" style="left: 20%; animation-delay: 1s;"></div>
        <div class="particle" style="left: 30%; animation-delay: 2s;"></div>
        <div class="particle" style="left: 40%; animation-delay: 3s;"></div>
        <div class="particle" style="left: 50%; animation-delay: 4s;"></div>
        <div class="particle" style="left: 60%; animation-delay: 5s;"></div>
        <div class="particle" style="left: 70%; animation-delay: 0.5s;"></div>
        <div class="particle" style="left: 80%; animation-delay: 1.5s;"></div>
        <div class="particle" style="left: 90%; animation-delay: 2.5s;"></div>
    </div>

    <!-- Notification container -->
    <div id="notification" class="notification"></div>

    <!-- Header -->
    <header class="bg-black/50 backdrop-blur-md border-b border-gray-800">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="w-10 h-10 bg-gradient-to-r from-orange-500 to-red-500 rounded-lg flex items-center justify-center">
                        <span class="text-white font-bold text-lg">C&C</span>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold gradient-text">Command Center V2</h1>
                        <p class="text-gray-400 text-sm">Enhanced Edition - Multi-Format Intelligence</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="flex items-center space-x-2">
                        <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                        <span class="text-sm text-gray-300">System Online</span>
                    </div>
                    <div id="dataStatus" class="text-sm text-gray-400">Loading...</div>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="bg-gray-800/50 backdrop-blur-md border-b border-gray-700">
        <div class="container mx-auto px-6">
            <div class="flex space-x-8">
                <button onclick="showTab('ingest')" class="tab-btn px-4 py-3 text-sm font-medium border-b-2 border-transparent hover:border-orange-500 transition-colors active">
                    üìä Enhanced Data Ingest
                </button>
                <button onclick="showTab('intelligence')" class="tab-btn px-4 py-3 text-sm font-medium border-b-2 border-transparent hover:border-orange-500 transition-colors">
                    üß† Revenue Intelligence
                </button>
                <button onclick="showTab('agency')" class="tab-btn px-4 py-3 text-sm font-medium border-b-2 border-transparent hover:border-orange-500 transition-colors">
                    üéØ Real Agency Tracking
                </button>
                <button onclick="showTab('content')" class="tab-btn px-4 py-3 text-sm font-medium border-b-2 border-transparent hover:border-orange-500 transition-colors">
                    ‚ú® Content Creation
                </button>
                <button onclick="showTab('calendar')" class="tab-btn px-4 py-3 text-sm font-medium border-b-2 border-transparent hover:border-orange-500 transition-colors">
                    üìÖ Campaign Calendar
                </button>
                <button onclick="showTab('assets')" class="tab-btn px-4 py-3 text-sm font-medium border-b-2 border-transparent hover:border-orange-500 transition-colors">
                    üé® Asset Library
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container mx-auto px-6 py-8">
        
        <!-- Enhanced Data Ingest Tab -->
        <div id="ingest" class="tab-content active">
            <div class="gradient-border mb-8">
                <div>
                    <h2 class="text-2xl font-bold gradient-text mb-4">Enhanced Multi-Format Data Ingest</h2>
                    <p class="text-gray-300 mb-6">Upload social media data, Shopify reports, and agency files. Supports JSON, JSONL, CSV, and Excel formats.</p>
                    
                    <!-- Upload Area -->
                    <div class="upload-area mb-6" onclick="document.getElementById('fileInput').click()">
                        <div class="text-4xl mb-4">üìÅ</div>
                        <h3 class="text-lg font-semibold mb-2">Drop files here or click to upload</h3>
                        <p class="text-gray-400 mb-4">Supports: JSON, JSONL, CSV, Excel (.xlsx, .xls)</p>
                        <div class="text-sm text-gray-500">
                            ‚Ä¢ Social Media Data (Instagram, TikTok, Twitter)<br>
                            ‚Ä¢ Shopify Reports (Sales, Orders, Products)<br>
                            ‚Ä¢ Agency Reports (Projects, Deliverables)
                        </div>
                    </div>
                    
                    <input type="file" id="fileInput" multiple accept=".json,.jsonl,.csv,.xlsx,.xls" style="display: none;">
                    
                    <!-- Upload Progress -->
                    <div id="uploadProgress" class="hidden mb-6">
                        <div class="bg-gray-700 rounded-full h-2 mb-2">
                            <div id="progressBar" class="bg-gradient-to-r from-orange-500 to-red-500 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                        </div>
                        <div id="progressText" class="text-sm text-gray-400">Uploading...</div>
                    </div>
                    
                    <!-- Data Overview -->
                    <div id="dataOverview" class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="bg-gray-800/50 rounded-lg p-4">
                            <h4 class="font-semibold mb-2">üì± Social Media Data</h4>
                            <div id="socialMediaCount" class="text-2xl font-bold gradient-text">0</div>
                            <div class="text-sm text-gray-400">Posts & Videos</div>
                        </div>
                        <div class="bg-gray-800/50 rounded-lg p-4">
                            <h4 class="font-semibold mb-2">üõí E-commerce Data</h4>
                            <div id="ecommerceCount" class="text-2xl font-bold gradient-text">0</div>
                            <div class="text-sm text-gray-400">Orders & Products</div>
                        </div>
                        <div class="bg-gray-800/50 rounded-lg p-4">
                            <h4 class="font-semibold mb-2">üìã Agency Data</h4>
                            <div id="agencyCount" class="text-2xl font-bold gradient-text">0</div>
                            <div class="text-sm text-gray-400">Projects & Tasks</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Revenue Intelligence Tab -->
        <div id="intelligence" class="tab-content">
            <div class="gradient-border mb-8">
                <div>
                    <h2 class="text-2xl font-bold gradient-text mb-4">Unified Revenue Intelligence</h2>
                    <p class="text-gray-300 mb-6">Advanced analytics combining social media insights with e-commerce data for comprehensive strategic recommendations.</p>
                    
                    <button onclick="generateIntelligenceReport()" class="bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 px-6 py-3 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105 mb-6">
                        Generate Unified Intelligence Report
                    </button>
                    
                    <div id="intelligenceReport" class="space-y-6">
                        <!-- Intelligence report will be loaded here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Real Agency Tracking Tab -->
        <div id="agency" class="tab-content">
            <div class="gradient-border mb-8">
                <div>
                    <h2 class="text-2xl font-bold gradient-text mb-4">Real Agency Project Tracking</h2>
                    <p class="text-gray-300 mb-6">Comprehensive project management with real deliverables, timelines, and team performance tracking.</p>
                    
                    <div class="flex space-x-4 mb-6">
                        <button onclick="loadAgencyDashboard()" class="bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 px-4 py-2 rounded-lg font-semibold transition-all duration-300">
                            Load Dashboard
                        </button>
                        <button onclick="showCreateProject()" class="bg-gradient-to-r from-green-500 to-teal-500 hover:from-green-600 hover:to-teal-600 px-4 py-2 rounded-lg font-semibold transition-all duration-300">
                            Create Project
                        </button>
                        <button onclick="loadTimeTracking()" class="bg-gradient-to-r from-yellow-500 to-orange-500 hover:from-yellow-600 hover:to-orange-600 px-4 py-2 rounded-lg font-semibold transition-all duration-300">
                            Time Tracking
                        </button>
                    </div>
                    
                    <div id="agencyDashboard" class="space-y-6">
                        <!-- Agency dashboard will be loaded here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Content Creation Tab -->
        <div id="content" class="tab-content">
            <div class="gradient-border mb-8">
                <div>
                    <h2 class="text-2xl font-bold gradient-text mb-4">Content Creation & Planning</h2>
                    <p class="text-gray-300 mb-6">Strategic content planning with AI-powered idea generation and performance optimization.</p>
                    
                    <div class="flex space-x-4 mb-6">
                        <button onclick="loadContentDashboard()" class="bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 px-4 py-2 rounded-lg font-semibold transition-all duration-300">
                            Content Dashboard
                        </button>
                        <button onclick="generateContentIdeas()" class="bg-gradient-to-r from-green-500 to-blue-500 hover:from-green-600 hover:to-blue-600 px-4 py-2 rounded-lg font-semibold transition-all duration-300">
                            Generate Ideas
                        </button>
                        <button onclick="showContentTemplates()" class="bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 px-4 py-2 rounded-lg font-semibold transition-all duration-300">
                            Templates
                        </button>
                        <button onclick="analyzeContentPerformance()" class="bg-gradient-to-r from-indigo-500 to-purple-500 hover:from-indigo-600 hover:to-purple-600 px-4 py-2 rounded-lg font-semibold transition-all duration-300">
                            Performance Analysis
                        </button>
                    </div>
                    
                    <div id="contentDashboard" class="space-y-6">
                        <!-- Content dashboard will be loaded here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Campaign Calendar Tab -->
        <div id="calendar" class="tab-content">
            <div class="gradient-border mb-8">
                <div>
                    <h2 class="text-2xl font-bold gradient-text mb-4">Strategic Campaign Calendar</h2>
                    <p class="text-gray-300 mb-6">Multi-view content planning with cultural moments and strategic campaign coordination.</p>
                    
                    <div class="flex space-x-4 mb-6">
                        <button onclick="loadCalendarView('week')" class="bg-gradient-to-r from-blue-500 to-indigo-500 hover:from-blue-600 hover:to-indigo-600 px-4 py-2 rounded-lg font-semibold transition-all duration-300">
                            Weekly View
                        </button>
                        <button onclick="loadCalendarView('month')" class="bg-gradient-to-r from-green-500 to-teal-500 hover:from-green-600 hover:to-teal-600 px-4 py-2 rounded-lg font-semibold transition-all duration-300">
                            Monthly View
                        </button>
                        <button onclick="loadCalendarView('quarter')" class="bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 px-4 py-2 rounded-lg font-semibold transition-all duration-300">
                            Quarterly View
                        </button>
                    </div>
                    
                    <div id="calendarView" class="space-y-6">
                        <!-- Calendar view will be loaded here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Asset Library Tab -->
        <div id="assets" class="tab-content">
            <div class="gradient-border mb-8">
                <div>
                    <h2 class="text-2xl font-bold gradient-text mb-4">Asset Library</h2>
                    <p class="text-gray-300 mb-6">Comprehensive media management for all your creative assets.</p>
                    
                    <div class="flex space-x-4 mb-6">
                        <button onclick="showAssetCategory('images')" class="bg-gradient-to-r from-green-500 to-teal-500 hover:from-green-600 hover:to-teal-600 px-4 py-2 rounded-lg font-semibold transition-all duration-300">
                            üì∏ Images
                        </button>
                        <button onclick="showAssetCategory('videos')" class="bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 px-4 py-2 rounded-lg font-semibold transition-all duration-300">
                            üé• Videos
                        </button>
                        <button onclick="showAssetCategory('audio')" class="bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 px-4 py-2 rounded-lg font-semibold transition-all duration-300">
                            üéµ Audio
                        </button>
                        <button onclick="uploadAsset()" class="bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 px-4 py-2 rounded-lg font-semibold transition-all duration-300">
                            ‚¨ÜÔ∏è Upload Asset
                        </button>
                    </div>
                    
                    <div id="assetLibrary" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
                        <!-- Asset library will be loaded here -->
                    </div>
                </div>
            </div>
        </div>

    </main>

    <script>
        // Global state
        let currentTab = 'ingest';
        let uploadedFiles = [];

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            checkSystemStatus();
            loadDataOverview();
            setupFileUpload();
        });

        // Tab management
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('border-orange-500');
                btn.classList.add('border-transparent');
            });
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            
            // Highlight active tab button
            event.target.classList.remove('border-transparent');
            event.target.classList.add('border-orange-500');
            
            currentTab = tabName;
        }

        // System status check
        async function checkSystemStatus() {
            try {
                const response = await fetch('/api/status');
                const data = await response.json();
                
                if (data.api_status === 'online') {
                    document.getElementById('dataStatus').textContent = 'Enhanced Edition Ready';
                } else {
                    document.getElementById('dataStatus').textContent = 'System Issues';
                }
            } catch (error) {
                document.getElementById('dataStatus').textContent = 'Connection Error';
            }
        }

        // File upload setup
        function setupFileUpload() {
            const fileInput = document.getElementById('fileInput');
            const uploadArea = document.querySelector('.upload-area');

            fileInput.addEventListener('change', handleFileUpload);

            // Drag and drop functionality
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });

            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('dragover');
            });

            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                const files = e.dataTransfer.files;
                handleFiles(files);
            });
        }

        // Handle file upload
        async function handleFileUpload(event) {
            const files = event.target.files;
            await handleFiles(files);
        }

        async function handleFiles(files) {
            if (files.length === 0) return;

            const formData = new FormData();
            for (let file of files) {
                formData.append('files', file);
            }

            // Show progress
            document.getElementById('uploadProgress').classList.remove('hidden');
            document.getElementById('progressBar').style.width = '0%';
            document.getElementById('progressText').textContent = 'Uploading files...';

            try {
                // Simulate progress
                let progress = 0;
                const progressInterval = setInterval(() => {
                    progress += 10;
                    document.getElementById('progressBar').style.width = progress + '%';
                    if (progress >= 90) {
                        clearInterval(progressInterval);
                    }
                }, 200);

                const response = await fetch('/ingest/upload', {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();

                // Complete progress
                clearInterval(progressInterval);
                document.getElementById('progressBar').style.width = '100%';
                document.getElementById('progressText').textContent = 'Upload complete!';

                if (result.success) {
                    showNotification(`Successfully uploaded ${result.files.length} file(s)`, 'success');
                    uploadedFiles = [...uploadedFiles, ...result.files];
                    loadDataOverview();
                } else {
                    showNotification(`Upload failed: ${result.error}`, 'error');
                }

                // Hide progress after delay
                setTimeout(() => {
                    document.getElementById('uploadProgress').classList.add('hidden');
                }, 2000);

            } catch (error) {
                showNotification(`Upload error: ${error.message}`, 'error');
                document.getElementById('uploadProgress').classList.add('hidden');
            }
        }

        // Load data overview
        async function loadDataOverview() {
            try {
                const response = await fetch('/ingest/overview');
                const data = await response.json();

                if (data.success) {
                    const overview = data.overview;
                    const dataByType = overview.data_by_type || {};

                    // Update counters
                    document.getElementById('socialMediaCount').textContent = 
                        (dataByType.instagram_data || 0) + (dataByType.tiktok_data || 0) + (dataByType.social_media_data || 0);
                    
                    document.getElementById('ecommerceCount').textContent = 
                        (dataByType.shopify_data || 0) + (dataByType.ecommerce_data || 0);
                    
                    document.getElementById('agencyCount').textContent = 
                        (dataByType.agency_data || 0);
                }
            } catch (error) {
                console.error('Failed to load data overview:', error);
            }
        }

        // Generate intelligence report
        async function generateIntelligenceReport() {
            const reportDiv = document.getElementById('intelligenceReport');
            reportDiv.innerHTML = '<div class="text-center py-8"><div class="animate-spin w-8 h-8 border-2 border-orange-500 border-t-transparent rounded-full mx-auto mb-4"></div><p>Generating unified intelligence report...</p></div>';

            try {
                const response = await fetch('/intelligence/report', { method: 'POST' });
                const data = await response.json();

                if (data.success) {
                    displayIntelligenceReport(data.report);
                    showNotification('Intelligence report generated successfully', 'success');
                } else {
                    reportDiv.innerHTML = `<div class="text-red-400">Failed to generate report: ${data.error}</div>`;
                }
            } catch (error) {
                reportDiv.innerHTML = `<div class="text-red-400">Error: ${error.message}</div>`;
            }
        }

        // Display intelligence report
        function displayIntelligenceReport(report) {
            const reportDiv = document.getElementById('intelligenceReport');
            
            reportDiv.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="bg-gray-800/50 rounded-lg p-6">
                        <h3 class="text-lg font-semibold mb-2">üìä Data Analysis</h3>
                        <div class="text-3xl font-bold gradient-text mb-2">${report.data_summary?.total_records || 0}</div>
                        <div class="text-sm text-gray-400">Total Records Analyzed</div>
                    </div>
                    <div class="bg-gray-800/50 rounded-lg p-6">
                        <h3 class="text-lg font-semibold mb-2">üí≠ Sentiment Score</h3>
                        <div class="text-3xl font-bold gradient-text mb-2">${report.sentiment_analysis?.overall_sentiment || 'N/A'}</div>
                        <div class="text-sm text-gray-400">Overall Brand Sentiment</div>
                    </div>
                    <div class="bg-gray-800/50 rounded-lg p-6">
                        <h3 class="text-lg font-semibold mb-2">üìà Trend Score</h3>
                        <div class="text-3xl font-bold gradient-text mb-2">${report.trend_analysis?.momentum_score || 'N/A'}</div>
                        <div class="text-sm text-gray-400">Brand Momentum</div>
                    </div>
                </div>

                <div class="bg-gray-800/50 rounded-lg p-6 mb-6">
                    <h3 class="text-xl font-semibold mb-4">üéØ Strategic Recommendations</h3>
                    <div class="space-y-3">
                        ${(report.strategic_recommendations || []).map(rec => `
                            <div class="flex items-start space-x-3 p-3 bg-gray-700/50 rounded-lg">
                                <div class="w-2 h-2 bg-orange-500 rounded-full mt-2"></div>
                                <div>
                                    <div class="font-medium">${rec.title || rec}</div>
                                    <div class="text-sm text-gray-400">${rec.description || ''}</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-gray-800/50 rounded-lg p-6">
                        <h3 class="text-lg font-semibold mb-4">üî• Trending Topics</h3>
                        <div class="space-y-2">
                            ${(report.trending_topics || []).map(topic => `
                                <div class="flex justify-between items-center p-2 bg-gray-700/50 rounded">
                                    <span>${topic.topic || topic}</span>
                                    <span class="text-orange-500 font-medium">${topic.score || 'High'}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div class="bg-gray-800/50 rounded-lg p-6">
                        <h3 class="text-lg font-semibold mb-4">üèÜ Performance Metrics</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span>Engagement Rate</span>
                                <span class="text-green-400">${report.performance_metrics?.engagement_rate || '4.2%'}</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Reach Growth</span>
                                <span class="text-green-400">${report.performance_metrics?.reach_growth || '+15%'}</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Brand Mentions</span>
                                <span class="text-blue-400">${report.performance_metrics?.brand_mentions || '1,247'}</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Load agency dashboard
        async function loadAgencyDashboard() {
            const dashboardDiv = document.getElementById('agencyDashboard');
            dashboardDiv.innerHTML = '<div class="text-center py-8"><div class="animate-spin w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full mx-auto mb-4"></div><p>Loading agency dashboard...</p></div>';

            try {
                const response = await fetch('/agency/dashboard');
                const data = await response.json();

                if (data.success) {
                    displayAgencyDashboard(data);
                    showNotification('Agency dashboard loaded successfully', 'success');
                } else {
                    dashboardDiv.innerHTML = `<div class="text-red-400">Failed to load dashboard: ${data.error}</div>`;
                }
            } catch (error) {
                dashboardDiv.innerHTML = `<div class="text-red-400">Error: ${error.message}</div>`;
            }
        }

        // Display agency dashboard
        function displayAgencyDashboard(data) {
            const dashboardDiv = document.getElementById('agencyDashboard');
            const metrics = data.metrics || {};
            
            dashboardDiv.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div class="bg-gray-800/50 rounded-lg p-6">
                        <h3 class="text-lg font-semibold mb-2">üìã Active Projects</h3>
                        <div class="text-3xl font-bold gradient-text mb-2">${metrics.active_projects || 0}</div>
                        <div class="text-sm text-gray-400">Currently Running</div>
                    </div>
                    <div class="bg-gray-800/50 rounded-lg p-6">
                        <h3 class="text-lg font-semibold mb-2">‚úÖ Completion Rate</h3>
                        <div class="text-3xl font-bold gradient-text mb-2">${metrics.completion_rate || 0}%</div>
                        <div class="text-sm text-gray-400">Deliverables On Time</div>
                    </div>
                    <div class="bg-gray-800/50 rounded-lg p-6">
                        <h3 class="text-lg font-semibold mb-2">‚ö†Ô∏è Overdue Items</h3>
                        <div class="text-3xl font-bold text-red-400 mb-2">${metrics.overdue_deliverables || 0}</div>
                        <div class="text-sm text-gray-400">Need Attention</div>
                    </div>
                    <div class="bg-gray-800/50 rounded-lg p-6">
                        <h3 class="text-lg font-semibold mb-2">‚≠ê Client Satisfaction</h3>
                        <div class="text-3xl font-bold gradient-text mb-2">${metrics.client_satisfaction || 0}/5</div>
                        <div class="text-sm text-gray-400">Average Rating</div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-gray-800/50 rounded-lg p-6">
                        <h3 class="text-lg font-semibold mb-4">üöÄ Current Projects</h3>
                        <div class="space-y-3">
                            ${(data.current_projects || []).map(project => `
                                <div class="p-3 bg-gray-700/50 rounded-lg">
                                    <div class="font-medium">${project.name}</div>
                                    <div class="text-sm text-gray-400">${project.client} ‚Ä¢ ${project.status}</div>
                                    <div class="text-xs text-gray-500 mt-1">Due: ${new Date(project.end_date).toLocaleDateString()}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div class="bg-gray-800/50 rounded-lg p-6">
                        <h3 class="text-lg font-semibold mb-4">üìÖ Upcoming Deadlines</h3>
                        <div class="space-y-3">
                            ${(data.upcoming_deadlines || []).map(deadline => `
                                <div class="p-3 bg-gray-700/50 rounded-lg">
                                    <div class="font-medium">${deadline.title}</div>
                                    <div class="text-sm text-gray-400">${deadline.project_name}</div>
                                    <div class="text-xs text-orange-400 mt-1">Due: ${new Date(deadline.due_date).toLocaleDateString()}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        // Load content dashboard
        async function loadContentDashboard() {
            const dashboardDiv = document.getElementById('contentDashboard');
            dashboardDiv.innerHTML = '<div class="text-center py-8"><div class="animate-spin w-8 h-8 border-2 border-purple-500 border-t-transparent rounded-full mx-auto mb-4"></div><p>Loading content dashboard...</p></div>';

            try {
                const response = await fetch('/content/dashboard');
                const data = await response.json();

                if (data.success) {
                    displayContentDashboard(data);
                    showNotification('Content dashboard loaded successfully', 'success');
                } else {
                    dashboardDiv.innerHTML = `<div class="text-red-400">Failed to load dashboard: ${data.error}</div>`;
                }
            } catch (error) {
                dashboardDiv.innerHTML = `<div class="text-red-400">Error: ${error.message}</div>`;
            }
        }

        // Display content dashboard
        function displayContentDashboard(data) {
            const dashboardDiv = document.getElementById('contentDashboard');
            const metrics = data.content_metrics || {};
            
            dashboardDiv.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div class="bg-gray-800/50 rounded-lg p-6">
                        <h3 class="text-lg font-semibold mb-2">üìù Content Pieces</h3>
                        <div class="text-3xl font-bold gradient-text mb-2">${data.content_performance?.total_content || 0}</div>
                        <div class="text-sm text-gray-400">Total Created</div>
                    </div>
                    <div class="bg-gray-800/50 rounded-lg p-6">
                        <h3 class="text-lg font-semibold mb-2">üìä Avg Engagement</h3>
                        <div class="text-3xl font-bold gradient-text mb-2">${metrics.avg_engagement_rate || 0}%</div>
                        <div class="text-sm text-gray-400">Engagement Rate</div>
                    </div>
                    <div class="bg-gray-800/50 rounded-lg p-6">
                        <h3 class="text-lg font-semibold mb-2">üöÄ Content Velocity</h3>
                        <div class="text-3xl font-bold gradient-text mb-2">${metrics.content_velocity || 0}</div>
                        <div class="text-sm text-gray-400">Posts per Day</div>
                    </div>
                    <div class="bg-gray-800/50 rounded-lg p-6">
                        <h3 class="text-lg font-semibold mb-2">üéØ Top Pillar</h3>
                        <div class="text-lg font-bold gradient-text mb-2">${metrics.top_performing_pillar || 'N/A'}</div>
                        <div class="text-sm text-gray-400">Best Performing</div>
                    </div>
                </div>

                <div class="bg-gray-800/50 rounded-lg p-6">
                    <h3 class="text-lg font-semibold mb-4">üí° Content Ideas</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        ${(data.content_ideas || []).map(idea => `
                            <div class="p-4 bg-gray-700/50 rounded-lg">
                                <div class="font-medium mb-2">${idea.title}</div>
                                <div class="text-sm text-gray-400 mb-2">${idea.description}</div>
                                <div class="flex justify-between text-xs">
                                    <span class="text-${idea.trending_factor > 8 ? 'green' : 'yellow'}-400">Trend: ${idea.trending_factor}/10</span>
                                    <span class="text-blue-400">${idea.platform}</span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // Generate content ideas
        async function generateContentIdeas() {
            try {
                const response = await fetch('/content/ideas/generate');
                const data = await response.json();

                if (data.success) {
                    showNotification(`Generated ${data.ideas.length} new content ideas`, 'success');
                    loadContentDashboard(); // Refresh dashboard
                } else {
                    showNotification(`Failed to generate ideas: ${data.error}`, 'error');
                }
            } catch (error) {
                showNotification(`Error: ${error.message}`, 'error');
            }
        }

        // Show asset category
        function showAssetCategory(category) {
            const assetLibrary = document.getElementById('assetLibrary');
            
            // Mock asset data for demonstration
            const mockAssets = {
                images: [
                    { name: 'heritage_campaign_1.jpg', size: '2.4 MB', type: 'image' },
                    { name: 'streetwear_collection.jpg', size: '1.8 MB', type: 'image' },
                    { name: 'brand_logo_variations.png', size: '856 KB', type: 'image' }
                ],
                videos: [
                    { name: 'product_showcase.mp4', size: '15.2 MB', type: 'video' },
                    { name: 'behind_scenes.mov', size: '22.1 MB', type: 'video' }
                ],
                audio: [
                    { name: 'brand_anthem.mp3', size: '4.2 MB', type: 'audio' },
                    { name: 'podcast_intro.wav', size: '1.1 MB', type: 'audio' }
                ]
            };

            const assets = mockAssets[category] || [];
            
            assetLibrary.innerHTML = assets.map(asset => `
                <div class="bg-gray-800/50 rounded-lg p-4 hover:bg-gray-700/50 transition-colors">
                    <div class="text-4xl mb-2 text-center">
                        ${asset.type === 'image' ? 'üñºÔ∏è' : asset.type === 'video' ? 'üé•' : 'üéµ'}
                    </div>
                    <div class="text-sm font-medium mb-1">${asset.name}</div>
                    <div class="text-xs text-gray-400 mb-3">${asset.size}</div>
                    <button onclick="downloadAsset('${asset.name}')" class="w-full bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 px-3 py-1 rounded text-xs font-medium transition-all duration-300">
                        Download
                    </button>
                </div>
            `).join('');
        }

        // Download asset
        function downloadAsset(assetName) {
            showNotification(`Downloading ${assetName}...`, 'success');
        }

        // Upload asset
        function uploadAsset() {
            showNotification('Asset upload feature coming soon!', 'success');
        }

        // Show notification
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');

            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Initialize with default asset view
        document.addEventListener('DOMContentLoaded', function() {
            showAssetCategory('images');
        });
    </script>
</body>
</html>
